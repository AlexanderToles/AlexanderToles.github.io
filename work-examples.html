<!doctype html>
<html>
    <head>
        <meta charset = "utf-8">
        <title>CS Work Examples</title>
        <style>
        button{
            font-size: 15px;
            text-align: left;
            font-family: Arial;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            background-color: #333533;
            position: relative;
            width: 100px;
        }
        .sortContainer{
            display:flex;
            justify-content: flex-start; /* aligns items left to right */
            align-items: flex-start; /* aligns items vertically at top */
            gap: 20px; /* space between sortContainer and canvas */
        }
        .sortControlContainer{
            width: 25vw;
            background-color: rgba(5, 190, 5,.5);
        }
        h1.heading{
            font-size:75px;
            text-align: center;
            font-family: Arial;
        }
        h2.subheading{
            font-size: 50px;
            text-align: left;
            font-family: Arial;
        }
        .selection{
            font-size: 15px;
            text-align: left;
            font-family: Arial;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            background-color: #333533;
            position: relative;
            width: 100px;
        }
        .selection:hover{
            background-color: #202020;
        }
        button.gen{
            background-color: rgb(5, 190, 5);
        }
        button.gen:hover{
            background-color:rgb(4, 147, 4);
        }
        .headerRibbon{
            position: sticky;
            top:0px;
            padding: 12px 40px;
            font-size: 30px;
            cursor: pointer;
            background-color: rgba(91, 91, 91, 0.5);
            color: white;
        }
        .btn {
            border: none;
            border-radius: 5px;
            padding: 12px 20px;
            font-size: 16px;
            text-decoration: none;
            font-family: Arial;
            background-color: #333533;
            color: white;
            position: relative;
        }
        .btn:hover{
            background-color: #202020;
        }
        .txt{
            font-size: 15px;
            font-family: Arial;
            color: #202020;
        }
        </style>
    </head>
    <body>
        <div class="headerRibbon" id="pageHeader">
        <a class = "btn" href = "index.html">Home</a>
        <a class = "btn" href = "work-examples.html">JS Examples</a>
        </div>
        <h1 class="heading">JavaScript Coding Examples</h1>
        <h2 class="subheading"> Sorting Algorithms <h2>
        <div class="sortContainer">
            <div class = "sortControlContainer">
                <p class = "selection" onclick="bubbleSort()">Bubble Sort</p>
                <p class = "selection" onclick="mergeSort()">Merge Sort</p>
            </div>
            <canvas width="600" height="600" ></canvas>
            <div>
            <input type="range" min="1" max="100" value="50" class="slider" id="rangeSlider">
            <p>Numbers to sort:<span id="numbersToSort"></span></p>
            <button class = "gen" onclick="generateFromSlider()">Generate</button>
            </div>
        </div>
        
        <script>
            
            var rSlider = document.getElementById('rangeSlider');
            var rSliderOutput = document.getElementById('numbersToSort');
            var rSliderVal = 0;
            var prev = 0;

            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            function valueCorrect(val){
                while(600%val != 0){
                    val++;
                }
                return val;
            }

            rSlider.oninput = function(){
                rSliderVal = valueCorrect(this.value);
                rSliderOutput.innerHTML = rSliderVal;
            }

            

            
            
            const algorithmDisplay = {
                canvas : document.querySelector("canvas"),
                context : document.querySelector("canvas").getContext("2d"),
                cellW : 0,
                cellH : 0,
                numElements: 0,
                running: 0,
                finished: 0,
                arr: [],
                generate: function(num){
                    this.finished = 0;
                    while(this.arr.length!=0){
                        this.arr.pop();
                    }
                    this.numElements = num;
                    this.cellW = Math.floor(600/num);
                    this.cellH = Math.floor(600/num);
                    this.context.fillStyle = "black";
                    this.context.fillRect(0,0,600,600);

                    

                    let tempArr = []; //create arrays, randomly pull values from temp, put into unsorted array
                    let unsortedArr = [];

                    for(let i = 1; i <= num; i++){ //populate temp array with number of vaules
                        tempArr.push(i);
                    }
                    
                    while(tempArr.length > 0){ 
                        randIdx = Math.floor(Math.random()*tempArr.length); //get random index
                        unsortedArr.push(tempArr[randIdx]); //add the value from that index into unsorted array
                        tempArr.splice(randIdx,1); //remove from temp index
                    }
                    //console.log(unsortedArr);
                    //console.log("this.cellW",this.cellW);
                    for(let i = 0; i < unsortedArr.length;i++){
                        this.arr.splice(i,0,unsortedArr[i]);
                    }
                    for(let i = 0; i < this.arr.length;i++){
                        this.draw(i,"#FFFF00");
                    }
                    console.log(this.numElements,this.cellH);
                },
                draw: function(idx,color){
                    this.context.fillStyle = "black";
                    this.context.fillRect(this.cellW*idx,0,this.cellW,600);
                    this.context.fillStyle = color;
                    this.context.fillRect(this.cellW*idx,600-(this.cellH*this.arr[idx]),this.cellW,this.cellH*this.arr[idx]);
                },
                swap: function(a,b){
                    let tempA = this.arr[a];
                    this.arr.splice(a,1,this.arr[b]);
                    this.arr.splice(b,1,tempA);
                    //console.log(this.arr[a],this.arr[b])
                    this.draw(a,"#FFFF00");
                    this.draw(b,"#CCCC00");
                },
                bubble: async function(){
                    this.running = 1;
                    for(let i = 0;i < this.arr.length;i++){
                        if(this.isSorted()){
                                console.log("sorted");
                                this.highlightThrough();
                                this.running = 0;
                                this.finished = 1;
                                break;
                            }
                        for(let j = 0; j < this.arr.length-1;j++){
                            if(j+1 > this.arr.length){
                                console.log("ERROR INDEX OUT OF RANGE");
                            }
                            if(this.arr[j] > this.arr[j+1]){
                                this.swap(j,j+1);
                                await sleep(50);
                            }
                            
                        }
                    }
                },
                merge: function(L1,L2){
                    let mergedList = [];
                    while(L1.length > 0 && L2.length > 0){
                        if(L1[0] < L2[0]){
                            mergedList.push(L1[0]);
                            L1.splice(0,1);
                        }else{
                            mergedList.push(L2[0]);
                            L2.splice(0,1);
                        }
                    if(L1.length ==0){
                        mergedList.push(L2[0]);
                    } else{
                        mergedList.push(L1[0]);
                    }
                    }
                    return mergedList;
                },
                recMerge: function(){
                    n = this.arr.length;
                    if (n == 1){
                        return this.arr;
                    }
                    let L1 = []
                    let L2 = []
                    for(let i = 0; i<(Math.floor(n/2));i++){
                        L1.push(this.arr[i])
                    }
                    for(let i = (Math.floor(n/2)) ; i<n;i++){
                        L2.push(this.arr[i])
                    }
                    return this.merge(this.rec_merge(L1),this.rec_merge(L2))
                },
                highlightThrough: async function(){
                    for(let i=0; i < this.arr.length;i++){
                        this.draw(i,"#90D5FF");
                        await sleep(50);
                    }
                },
                isSorted: function(){
                    let i = 0;
                    while(this.arr[i]<this.arr[i+1]){
                        i++;
                    }
                    if (i == this.arr.length-1){
                        return true;
                    }
                    else{return false;}
                },
            }

            algorithmDisplay.generate(0);
            function bubbleSort(){
                if(!algorithmDisplay.running && !algorithmDisplay.finished){
                    algorithmDisplay.bubble();
                }
                
            }
            function mergeSort(){
                if(!algorithmDisplay.running && !algorithmDisplay.finished){
                    algorithmDisplay.merge();
                }
                
            }
            function generateFromSlider(){
                if(!algorithmDisplay.running){
                    algorithmDisplay.generate(rSliderVal);
                }
                
            }

            
        </script>
    </body>
</html>
